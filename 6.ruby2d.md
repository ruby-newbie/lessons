# 6. Ruby2d

## Чему научитесь:
- устанавливать библиотеки в ruby и использовать в своём коде
- писать простые игры с помощью библиотеки ruby2d

## Материалы для изучения

[Библиотеки и RubyGems](https://rubyrush.ru/steps/rubygems)

## Вопросы

- зачем нужны библиотеки в программировании?  
- если использовали менеджеры пакетов/системы управления библиотеками , расскажите о своём опыте  

## Практика

### Rubygems и Bundler

Пришло время устанавливать библиотеки:  

[Rubygems](https://rubygems.org/) - gem hosting service  
[Bundler](https://bundler.io/) - provides a consistent environment for Ruby projects by tracking and installing the exact gems and versions that are needed.  

rubygems должке быть установлен вместе с Ruby, проверим:

```bash
gem -v
```

Список установленных библиотек (гемов):

```bash
gem list
```

Ищем bundler:

```bash
gem list | grep "bundler"
```

[Больше о grep](https://selectel.ru/blog/tutorials/grep-command-in-linux/)


### Ruby 2d

Фреймворк [Ruby2d](https://www.ruby2d.com/)

[Get started with Ruby 2d](https://www.ruby2d.com/learn/get-started/)


### Создание пространства для экспериментов

- создаём отдельную директорию (обратите внимание, чтобы она не была внутри существующего репозитория)
- создаём `Gemfile`, записываем туда:

```Gemfile
source 'https://rubygems.org'

gem 'ruby2d'
```

Устанавливаем указанные в Gemfile гемы командой:

```bash
bundle install
```

Выполнять код будем:

```bash
bundle exec ruby файл.rb
```

[Getting started with ruby2d](https://www.ruby2d.com/learn/get-started/)  

### Hello world для ruby2d

Попробуем простой код с использованием ruby2d:
- создадим файл
- нарисуем треугольник

```ruby
require 'ruby2d'

set title: "Hello Triangle"

Triangle.new(
  x1: 320, y1:  50,
  x2: 540, y2: 430,
  x3: 100, y3: 430,
  color: ['red', 'green', 'blue']
)

show
```

### Изменение положения фигуры, управление с клавиатуры

Для слeдующего эксперимента создадим отдельный файл.  

Нарисуем квадрат, которым мы сможем управлять с клавиатуры.

- рисуем [квадрат](https://www.ruby2d.com/learn/shapes/#squares)
- [обработка нажатия клавиш](https://www.ruby2d.com/learn/input/)
- [система координат + основы 2d](https://www.ruby2d.com/learn/2d-basics/)

Возьмём [пример](https://www.ruby2d.com/learn/2d-basics/#example-of-moving-a-square-shape-with-keys).

- изменим размеры, цвет, стартовую позицию квадрата

Обратите внимание на:

- обработку нажатий клавиш:

```ruby
on :key_down do |event|
  # здесь доступен объект event, можно изучить его свойства
  puts event
end
```

- цикл `update`

- изменение значений переменных `@x_speed`, `@y_speed`

- измените программу так, чтобы менялись не скорость движения, а координаты фигуры (`@square.x`, `@square.y`)
(можно менять скорость с помощью одних клавиш, а координаты - с помощью других)

- добавьте возвращение фигуры на исходное место (значение координат фигуры и скоростей - вернуть в исходные значения)
- измените программу так, чтобы управлять другими клавишами

(клавишам направлений будут соответствовать строки 'left', 'right', 'up', 'down', пробел - 'space')

- поэкспериментируйте с управлением и параметрами фигуры

Используйте оператор `case` вместо множества `if-else`:

```ruby
case fruit
when 'banana'
  puts "Это банан"
when 'apple'
  puts "Это яблоко"
when 'orange'
  puts "Это апельсин"
else
  puts "Это какой-то непонятный фрукт"
end
```

будет соответствовать коду с if-elsif:

```ruby
if fruit == 'banana'
  puts "Это банан"
elsif fruit == 'apple'
  puts "Это яблоко"
elsif fruit == 'orange'
  puts "Это апельсин"
else
  puts "Это какой-то непонятный фрукт"
end

```

[вариант готовой программы](https://github.com/ruby-newbie/lessons/blob/main/code/square.rb)

### Пишем игру "Попади по рубину":

[Прочитайте о спрайтах и их использовании](https://www.ruby2d.com/learn/sprites/)

Мы будем использовать простой спрайт из двух кадров.
Вы можете использовать картинку или заменить на свою.

- отображение спрайта и текста
- работа в цикле `update`
- реакция на клики мышкой
- считаем score
- конец игры/удаляем картинку

TODO:
[вариант готовой программы](#)